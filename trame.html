<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trame - R√©diger une chronique radio</title>

  <!-- CSS principal -->
  <link rel="stylesheet" href="style.css" />

  <!-- jsPDF depuis CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
  <script src="https://unpkg.com/@mlc-ai/web-llm/dist/web-llm.min.js" defer></script>

  <style>
    /* üéØ Styles de base pour les onglets */
    .tabs { display: flex; gap: .5rem; flex-wrap: wrap; margin: 1rem 0; }
    .tab-btn { border: 1px solid #e0e6ef; background: #f7f9fc; padding: .5rem .75rem; border-radius: 8px; cursor: pointer; }
    .tab-btn.active { background: #dfe9ff; border-color: #7aa2ff; }
    .tab-panel { display: none; }
    .tab-panel.active { display: block; }
    .small { font-size: .9rem; color: #54667a; }
    .row { display: grid; gap: .5rem; grid-template-columns: 1fr 1fr; }
    .row > * { min-width: 0; }
    .dev-field { margin-bottom: .75rem; }
    .actions { display:flex; gap:.5rem; flex-wrap:wrap; }
    details > summary { cursor: pointer; }
    .split-3 { display:grid; grid-template-columns:1fr 1fr 1fr; gap:.5rem; }
    .split-2 { display:grid; grid-template-columns:1fr 1fr; gap:.5rem; }
    .chip { display:inline-block; padding:.15rem .5rem; border-radius:999px; background:#eef3ff; margin-right:.25rem; font-size:.85rem; }
    textarea, input { width:100%; }
  </style>
</head>
<body>
  <!-- üîπ Menu fixe -->
  <nav class="navbar">
    <a href="index.html">üè† Accueil</a>
    <a href="trame.html">‚úçÔ∏è Trame</a>
    <a href="annexe.html">üìë Annexe</a>
  </nav>

  <header>
    <h1>Trame</h1>
    <h2>R√©dige ta chronique radio</h2>
  </header>

  <main>
    <!-- üö¶ S√©lecteur d‚Äôonglet -->
    <div class="tabs" role="tablist" aria-label="Modes de r√©daction">
      <button class="tab-btn active" data-tab="libre" role="tab" aria-selected="true" aria-controls="panel-libre">üìù Mode libre</button>
      <button class="tab-btn" data-tab="guide" role="tab" aria-selected="false" aria-controls="panel-guide">üéØ √âcriture guid√©e (texte √† trous)</button>
      <button class="tab-btn" data-tab="itw" role="tab" aria-selected="false" aria-controls="panel-itw">üéôÔ∏è Interview</button>
    </div>

    <!-- üìù MODE LIBRE (formulaire existant) -->
    <section id="panel-libre" class="tab-panel active" role="tabpanel" aria-labelledby="tab-libre">
      <form class="trame-form" onsubmit="return false;">
        <h2>Rappel : Les 5W du journalisme</h2>
        <ul class="fivew">
          <li><strong>Who ?</strong> Qui est concern√© ?</li>
          <li><strong>What ?</strong> De quoi s‚Äôagit-il ?</li>
          <li><strong>Where ?</strong> O√π cela se passe-t-il ?</li>
          <li><strong>When ?</strong> Quand cela a-t-il lieu ?</li>
          <li><strong>Why ?</strong> Pourquoi en parler ?</li>
        </ul>

        <h2>Introduction</h2>
        <label for="intro1">1) D√©finition / phrase g√©n√©rale :</label>
        <textarea id="intro1" rows="3"></textarea>

        <label for="intro2">2) Probl√©matique :</label>
        <textarea id="intro2" rows="3"></textarea>

        <label for="intro3">3) Annonce du plan :</label>
        <textarea id="intro3" rows="3"></textarea>

        <h2>D√©veloppement</h2>
        <div id="dev-container">
          <div class="dev-field">
            <label>Argument 1 + exemple :</label>
            <textarea rows="4"></textarea>
          </div>
        </div>
        <button type="button" id="addArgBtn">‚ûï Ajouter un argument</button>

        <h2>Conclusion</h2>
        <label for="concl1">1) R√©sum√© avec d‚Äôautres mots :</label>
        <textarea id="concl1" rows="3"></textarea>

        <label for="concl2">2) Nouvelle question :</label>
        <textarea id="concl2" rows="3"></textarea>

        <div class="actions">
          <button type="button" id="compileBtn">‚úÖ Valider et compiler</button>
          <button type="button" id="resetBtn">üóëÔ∏è Nouvelle chronique</button>
        </div>
      </form>
    </section>

    <!-- üéØ MODE GUID√â (texte √† trous √©largi) -->
    <section id="panel-guide" class="tab-panel" role="tabpanel" aria-labelledby="tab-guide">
      <form class="trame-form" onsubmit="return false;">
        <h2>√âcriture guid√©e ‚Äî chronique</h2>
        <p class="small">Remplis les champs : le script se g√©n√®re automatiquement. Tu peux modifier la trame. Les variables <code>{{ }}</code> seront remplac√©es.</p>

        <div class="row">
          <div>
            <label for="g_radio">Nom de la radio :</label>
            <input id="g_radio" type="text" placeholder="Radio √âmeraude" />
          </div>
          <div>
            <label for="g_college">Nom du coll√®ge :</label>
            <input id="g_college" type="text" placeholder="Coll√®ge ***" />
          </div>
          <div>
            <label for="g_theme">Th√®me / sujet :</label>
            <input id="g_theme" type="text" placeholder="le harc√®lement scolaire" />
          </div>
          <div>
            <label for="g_date">Date (optionnelle) :</label>
            <input id="g_date" type="text" placeholder="20 octobre 2025" />
          </div>
        </div>

        <h3>Autour de la table</h3>
        <div id="g_participants"></div>
        <div class="actions" style="margin:.5rem 0 1rem;">
          <button type="button" id="btnAddP">‚ûï Ajouter un intervenant</button>
          <button type="button" id="btnClearP">üßπ Vider la liste</button>
        </div>

        <details open>
          <summary><strong>D√©veloppement ‚Äî points guid√©s</strong> <span class="small">(facultatif)</span></summary>
          <div class="split-3">
            <div>
              <label for="g_dev1">Id√©e 1 :</label>
              <input id="g_dev1" type="text" placeholder="constat / d√©finition pr√©cise" />
              <label for="g_ex1" class="small">Exemple 1 :</label>
              <textarea id="g_ex1" rows="3" placeholder="Exemple court, t√©moin, chiffre‚Ä¶"></textarea>
            </div>
            <div>
              <label for="g_dev2">Id√©e 2 :</label>
              <input id="g_dev2" type="text" placeholder="cause / cons√©quence" />
              <label for="g_ex2" class="small">Exemple 2 :</label>
              <textarea id="g_ex2" rows="3" placeholder="Exemple court, ressource, citation‚Ä¶"></textarea>
            </div>
            <div>
              <label for="g_dev3">Id√©e 3 :</label>
              <input id="g_dev3" type="text" placeholder="solution / piste d‚Äôaction" />
              <label for="g_ex3" class="small">Exemple 3 :</label>
              <textarea id="g_ex3" rows="3" placeholder="Conseil concret, lien, service d‚Äôaide‚Ä¶"></textarea>
            </div>
          </div>
        </details>

        <details open>
          <summary><strong>Conclusion ‚Äî phrases guid√©es</strong></summary>
          <div class="split-2">
            <div>
              <label for="g_conc_resume">R√©sum√© en une phrase :</label>
              <textarea id="g_conc_resume" rows="2" placeholder="Ce qu‚Äôil faut retenir‚Ä¶"></textarea>
            </div>
            <div>
              <label for="g_conc_ouverture">Ouverture / question :</label>
              <textarea id="g_conc_ouverture" rows="2" placeholder="Et maintenant ? Que faire / o√π se renseigner ?"></textarea>
            </div>
          </div>
          <label for="g_conc_appel" class="small">Appel √† l‚Äôaction (facultatif) :</label>
          <input id="g_conc_appel" type="text" placeholder="Parlez-en, demandez de l‚Äôaide, contactez‚Ä¶" />
        </details>

        <details>
          <summary>Mod√®le (√©ditable)</summary>
          <p class="small">Tu peux modifier la trame ci-dessous. Variables disponibles : <span class="chip">{{radio}}</span><span class="chip">{{college}}</span><span class="chip">{{theme}}</span><span class="chip">{{date}}</span><span class="chip">{{participants}}</span><span class="chip">{{p1}}</span><span class="chip">{{dev1}}</span><span class="chip">{{ex1}}</span><span class="chip">{{dev2}}</span><span class="chip">{{ex2}}</span><span class="chip">{{dev3}}</span><span class="chip">{{ex3}}</span><span class="chip">{{conc_resume}}</span><span class="chip">{{conc_ouverture}}</span><span class="chip">{{conc_appel}}</span></p>
          <textarea id="g_template" rows="16" style="width:100%;">
Chers auditeurs, bonjour ! Nous sommes r√©unis aujourd‚Äôhui dans le studio de la {{radio}} du coll√®ge {{college}} {{date? (le {{date}}) :}} pour parler de {{theme}}.

Autour de la table : {{participants}}.

‚û°Ô∏è Introduction
Bonjour √† toutes et √† tous, je m‚Äôappelle {{p1}} et aujourd‚Äôhui, on aborde {{theme}} : pourquoi c‚Äôest important et ce que cela change pour nous.

‚û°Ô∏è D√©veloppement
‚Ä¢ Id√©e 1 : {{dev1}}
  Exemple : {{ex1}}
‚Ä¢ Id√©e 2 : {{dev2}}
  Exemple : {{ex2}}
‚Ä¢ Id√©e 3 : {{dev3}}
  Exemple : {{ex3}}

‚û°Ô∏è Conclusion
R√©sum√© : {{conc_resume}}
Ouverture : {{conc_ouverture}}
{{conc_appel}}

Merci √† {{participants}} pour leur participation, et merci √† vous, ch√®res auditrices et chers auditeurs, de nous avoir √©cout√©s sur la {{radio}} ! √Ä tr√®s bient√¥t.
          </textarea>
        </details>

        <div class="actions" style="margin-top:1rem;">
          <button type="button" id="btnGenGuide">‚úÖ G√©n√©rer le script guid√©</button>
          <button type="button" id="btnInsertGuide">üì• Ins√©rer dans la ‚ÄòChronique finale‚Äô</button>
        </div>

        <h3>Aper√ßu du script</h3>
        <pre id="g_preview" style="white-space:pre-wrap; background:#f4f7fa; padding:1rem; border-radius:8px;"></pre>
      </form>
    </section>

    <!-- üéôÔ∏è MODE INTERVIEW -->
    <section id="panel-itw" class="tab-panel" role="tabpanel" aria-labelledby="tab-itw">
      <form class="trame-form" onsubmit="return false;">
        <h2>Interview ‚Äî trame sp√©ciale</h2>
        <p class="small">Pr√©pare ton interview : introduction, pr√©sentation invit√©¬∑e, questions, relances, conclusion et remerciements.</p>

        <div class="row">
          <div>
            <label for="i_radio">Nom de la radio :</label>
            <input id="i_radio" type="text" placeholder="Radio √âmeraude" />
          </div>
          <div>
            <label for="i_college">Nom du coll√®ge :</label>
            <input id="i_college" type="text" placeholder="Coll√®ge ***" />
          </div>
          <div>
            <label for="i_theme">Sujet de l‚Äôinterview :</label>
            <input id="i_theme" type="text" placeholder="pr√©vention du harc√®lement" />
          </div>
          <div>
            <label for="i_date">Date (optionnelle) :</label>
            <input id="i_date" type="text" placeholder="20 octobre 2025" />
          </div>
        </div>

        <div class="split-2" style="margin-top:.5rem;">
          <div>
            <label for="i_interviewer">Interviewer¬∑euse :</label>
            <input id="i_interviewer" type="text" placeholder="Pr√©nom 1" />
          </div>
          <div>
            <label for="i_guest">Invit√©¬∑e (nom + r√¥le) :</label>
            <input id="i_guest" type="text" placeholder="Mme Dupont, CPE" />
          </div>
        </div>

        <h3>Questions & relances</h3>
        <div id="i_questions"></div>
        <div class="actions" style="margin:.5rem 0 1rem;">
          <button type="button" id="btnAddQ">‚ûï Ajouter une question</button>
          <button type="button" id="btnClearQ">üßπ Vider les questions</button>
        </div>

        <details>
          <summary>Mod√®le (√©ditable)</summary>
          <p class="small">Variables : <span class="chip">{{i_radio}}</span><span class="chip">{{i_college}}</span><span class="chip">{{i_theme}}</span><span class="chip">{{i_date}}</span><span class="chip">{{i_interviewer}}</span><span class="chip">{{i_guest}}</span><span class="chip">{{i_bloc}}</span></p>
          <textarea id="i_template" rows="16" style="width:100%;">
Ch√®res auditrices, chers auditeurs, bonjour ! Vous √™tes sur {{i_radio}} au coll√®ge {{i_college}} {{i_date? (le {{i_date}}) :}}. Aujourd‚Äôhui, nous recevons {{i_guest}} pour parler de {{i_theme}}.

‚û°Ô∏è Pr√©sentation
{{i_interviewer}} ‚Äî Bonjour et merci d‚Äô√™tre avec nous. Pour commencer, pouvez-vous vous pr√©senter en quelques mots ?

‚û°Ô∏è Questions
{{i_bloc}}

‚û°Ô∏è Conclusion
Merci {{i_guest}} pour vos √©clairages. Un dernier mot pour nos auditeurs et auditrices ?

Merci √† toutes et tous de nous avoir √©cout√©s sur {{i_radio}}. √Ä tr√®s bient√¥t !
          </textarea>
        </details>

        <div class="actions" style="margin-top:1rem;">
          <button type="button" id="btnGenItw">‚úÖ G√©n√©rer l‚Äôinterview</button>
          <button type="button" id="btnInsertItw">üì• Ins√©rer dans la ‚ÄòChronique finale‚Äô</button>
        </div>

        <h3>Aper√ßu de l‚Äôinterview</h3>
        <pre id="i_preview" style="white-space:pre-wrap; background:#f4f7fa; padding:1rem; border-radius:8px;"></pre>
      </form>
    </section>

    <!-- üîª Zone commune de sortie & export -->
    <section>
      <h2>Chronique finale</h2>
      <pre id="resultat" style="white-space: pre-wrap; background:#f4f7fa; padding:1rem; border-radius:8px;"></pre>

    <div class="actions" style="margin-top:.5rem;">
      <button type="button" id="btnRewriteLocal">‚ú® R√©√©crire (IA locale ‚Äî gratuit)</button>
    </div>
    <p id="iaLocalStatus" class="small" style="margin:.5rem 0 0; color:#54667a;"></p>


      <div class="export">
        <label for="fontSelect">Typographie :</label>
        <select id="fontSelect">
          <option value="times">Times</option>
          <option value="helvetica" selected>Helvetica</option>
          <option value="courier">Courier</option>
        </select>

        <label for="fontSize">Taille :</label>
        <input type="number" id="fontSize" value="12" min="8" max="30" />

        <button type="button" id="exportPdfBtn">üìÑ Exporter en PDF</button>
      </div>
    </section>
  </main>

  <!-- JS de la page (s√©par√©) -->
  <script src="trame.js" defer></script>
  <script src="ai-local.js" defer></script>

</body>
</html>
